<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Guillaume Gilles</title>
<link>https://guillaumegilles.github.io/blog.html</link>
<atom:link href="https://guillaumegilles.github.io/blog.xml" rel="self" type="application/rss+xml"/>
<description>Where I cultivate corner of the World Wide Web</description>
<generator>quarto-1.4.537</generator>
<lastBuildDate>Sat, 22 Mar 2025 23:00:00 GMT</lastBuildDate>
<item>
  <title>Nested Quarto Website</title>
  <dc:creator>Guillaume Gilles</dc:creator>
  <link>https://guillaumegilles.github.io/blog/nested-quarto-projects/</link>
  <description><![CDATA[ 





<p><a href="https://quarto.org/docs/projects/quarto-projects.html">Quarto projects</a> are directories designed to make publishing collections of documents easy, whether as a blog or a full website. They can also be used to create books and manuscripts in both print formats (PDF and MS Word) and online formats (HTML and ePub). For example, Quarto websites allow for shared navigation, consistent visual styling, customizable rendering options, and dynamic output using Python, R, Julia, and Observable.</p>
<section id="how-do-quarto-projects-work" class="level2">
<h2 class="anchored" data-anchor-id="how-do-quarto-projects-work">How do Quarto projects work?</h2>
<p>At the root of your directory, a YAML file, <code>_quarto.yml</code>, defines metadata that is shared across multiple documents. Any document rendered within the project directory automatically inherits this metadata. The default <code>_quarto.yml</code> file for creating a website look like this:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">project</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb1-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">type</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> website</span></span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">website</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb1-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"today"</span></span>
<span id="cb1-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">navbar</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb1-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb1-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">href</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> index.qmd</span></span>
<span id="cb1-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Home</span></span>
<span id="cb1-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> about.qmd</span></span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb1-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb1-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> cosmo</span></span>
<span id="cb1-15"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">css</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> styles.css</span></span>
<span id="cb1-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">toc</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span></code></pre></div>
<p>With these basic metadata, Quarto will produce an elegant website, with a navigation bar shared across multiple documents, such as the website’s home page, <code>index.qmd</code>, and an about page, <code>about.qmd</code>.</p>
</section>
<section id="one-website-to-rule-them-all-a-quarto-dilemma" class="level2">
<h2 class="anchored" data-anchor-id="one-website-to-rule-them-all-a-quarto-dilemma">One Website to Rule Them All: A Quarto Dilemma</h2>
<p>I love Quarto simplicity and versatility so much that I use it everywhere. My website, teaching materials, blog posts, and projects are all built with Quarto. For a coherent user experience between these different projects, my setup ensures that everything shares the same navigation bar, footer, and overall graphical identity while allowing seamless access to my home and about pages from any webpage.</p>
<p>The goals of this workflow are:</p>
<ol type="1">
<li>Hosted directly from your GitHub repository, thanks to <a href="https://pages.github.com/">GitHub Pages</a></li>
<li>Standalone GitHub repository with GitHub Pages enabled so they are independantly accessible.</li>
<li>Finally, a personnal website as a central hub for all my online contents.</li>
</ol>
<p>In order to achieve this goal, <code>/home/guillaume/website/</code> directory on my local machine look like this (<em>edited for clarity</em>):</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode md code-with-copy"><code class="sourceCode markdown"><span id="cb2-1">.</span>
<span id="cb2-2">├── _quarto.yml                             # Root YAML configuration file for the Quarto project</span>
<span id="cb2-3">├── blog/                                   # Directory for blog posts</span>
<span id="cb2-4">├── projects/                               # Directory containing various projects</span>
<span id="cb2-5">│   ├── machine-learning/                   # Machine Learning project</span>
<span id="cb2-6">│   │   ├── _quarto.yml                     # Quarto configuration specific to this project</span>
<span id="cb2-7">│   │   ├── …                               # Other project files</span>
<span id="cb2-8">├── teaching/                               # Directory storing subdirectories for different courses</span>
<span id="cb2-9">│   ├── data-description/                   # Data Description course</span>
<span id="cb2-10">│   │   ├── _quarto.yml                     # Quarto configuration for this course</span>
<span id="cb2-11">│   │   ├── …                               # Other course files</span>
<span id="cb2-12">│   ├── management-information-system/      # Management Information System course</span>
<span id="cb2-13">│   │   ├── _quarto.yml                     # Quarto configuration for this course</span>
<span id="cb2-14">│   │   ├── …                               # Other course files</span>
<span id="cb2-15">└── index.md                                # Website's home page</span></code></pre></div>
<p>As you can see, it contains a <code>_quarto.yml</code> at the root level for my website defining</p>
<p>several subdirectorires, each with its own independent <code>_quarto.yml</code> metadata file. Since a Quarto project requires a single <code>_quarto.yml</code> file at the root of the directory, having multiple <code>_quarto.yml</code> files at different levels causes conflicts, making the directory structure unworkable.</p>
<p>To host all my Quarto projects within my personal website, I needed to find a workaround.</p>
<section id="prevent-rendering-of-subdirectory-projects" class="level3">
<h3 class="anchored" data-anchor-id="prevent-rendering-of-subdirectory-projects">Prevent Rendering of Subdirectory Projects</h3>
<p>The first step is to prevent subdirectories from being rendered. Fortunately, the Quarto developers have implemented a simple yet effective feature: any file or directory prefixed with <code>_</code> is ignored during the rendering stage of the <code>quarto render</code> command.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb3-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.</span></span>
<span id="cb3-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">├── _quarto.yml</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                             # Root YAML configuration file for the Quarto project</span></span>
<span id="cb3-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">├── blog/</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                                   # Directory for blog posts</span></span>
<span id="cb3-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">├── projects/</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                               # Directory containing various projects</span></span>
<span id="cb3-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">│   ├── _machine-learning/</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                  # Machine Learning project</span></span>
<span id="cb3-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">│   │   ├── _quarto.yml</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                     # Quarto configuration specific to this project</span></span>
<span id="cb3-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">│   │   ├── …</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                               # Other project files</span></span>
<span id="cb3-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">├── teaching/</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                               # Directory storing subdirectories for different courses</span></span>
<span id="cb3-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">│   ├── _data-description/</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                  # Data Description course</span></span>
<span id="cb3-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">│   │   ├── _quarto.yml</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                     # Quarto configuration for this course</span></span>
<span id="cb3-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">│   │   ├── …</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                               # Other course files</span></span>
<span id="cb3-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">│   ├── _management-information-system/</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">     # Management Information System course</span></span>
<span id="cb3-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">│   │   ├── _quarto.yml</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                     # Quarto configuration for this course</span></span>
<span id="cb3-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">│   │   ├── …</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                               # Other course files</span></span>
<span id="cb3-15"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">└── index.md</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                                # Website's home page</span></span></code></pre></div>
</section>
<section id="rendering-independant-subdirectories" class="level3">
<h3 class="anchored" data-anchor-id="rendering-independant-subdirectories">Rendering independant subdirectories</h3>
<p>In my example, <code>_machine-learning/</code> or <code>_management-information-system/</code> are independant projects with multiple files and their own metadata YAML file. To ensure a coherent user experience inside my website, I needed to make sure their metadata will match the directory structure they will be living after being rendered by Qaurto.</p>
<hr>
<ol type="1">
<li>Need to have navbar properties inside references. so only book + website :</li>
</ol>
<ul>
<li>website: https://quarto.org/docs/reference/projects/websites.html#navbar</li>
<li>book: https://quarto.org/docs/reference/projects/books.html#navbar</li>
</ul>
<ol start="2" type="1">
<li>render sub project 2.1 render entire website except subfolder https://quarto.org/docs/websites/index.html#render-targets _strategic-qsfsqdfqs</li>
</ol>
<ul class="task-list">
<li><label><input type="checkbox">teaching/teaching.yml = links to html page following the docs/ directories structure</label></li>
</ul>
<p>using teaching-listing.yml for listing properties inside teaching.qmd</p>
</section>
</section>
<section id="setps" class="level2">
<h2 class="anchored" data-anchor-id="setps">Setps</h2>
<ol type="1">
<li><code>quarto render</code> projects and teaching</li>
<li>make sure <code>_quarto.yml</code> sub-projects information take into consideration the website <code>docs</code> directory hierarchy. <code>../../about.html</code> jump 2 levels, from specific projects to teaching level, then to root level of website.</li>
</ol>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode yml code-with-copy"><code class="sourceCode yaml"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">  # Navbar</span></span>
<span id="cb4-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">navbar</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb4-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">logo</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ../../images/cat.png</span></span>
<span id="cb4-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span></span>
<span id="cb4-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">right</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb4-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ABOUT</span></span>
<span id="cb4-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">href</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ../../about.html</span></span>
<span id="cb4-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> PROJECTS</span></span>
<span id="cb4-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">href</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ../../projects.html</span></span>
<span id="cb4-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> TEACHING</span></span>
<span id="cb4-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">href</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ../../teaching.html</span></span>
<span id="cb4-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> BLOG</span></span>
<span id="cb4-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">href</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ../../blog.html</span></span></code></pre></div>
<ol start="2" type="1">
<li><code>quarto render</code> website</li>
<li>Moving each <code>docs/</code> sub-projects into website’s <code>docs/teaching</code> or <code>docs/projects</code> directories (since each render of the website wipes out the <code>docs/</code> directory).</li>
</ol>
<ul>
<li>rename appropriately from <code>docs/</code> to <code>description-donnees</code> for example.</li>
</ul>
</section>
<section id="automatation" class="level2">
<h2 class="anchored" data-anchor-id="automatation">Automatation</h2>
<ul>
<li>R</li>
<li>scripts
<ul>
<li>build_website</li>
</ul></li>
</ul>
<p>Yes! Since Step #2 already processes the directories, we can <strong>remove the redundant loop</strong> in Step #3 and just copy the files.</p>
<hr>
<section id="updated-shell-script-build_site.sh" class="level3">
<h3 class="anchored" data-anchor-id="updated-shell-script-build_site.sh"><strong>Updated Shell Script (<code>build_site.sh</code>)</strong></h3>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exit on error</span></span>
<span id="cb5-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span></span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 1: Render the Quarto project</span></span>
<span id="cb5-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rendering Quarto project..."</span></span>
<span id="cb5-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">quarto</span> render</span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 2: Create one level of subdirectories inside docs/, removing `_`</span></span>
<span id="cb5-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Creating directory structure in docs/..."</span></span>
<span id="cb5-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> dir <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> teaching projects<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb5-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-maxdepth</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-type</span> d <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">subdir</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb5-14">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove leading `_` from directory names</span></span>
<span id="cb5-15">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clean_subdir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$subdir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s|/_|/|g'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s|^_||'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-16"></span>
<span id="cb5-17">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Construct the corresponding directory inside docs/</span></span>
<span id="cb5-18">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">newdir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$clean_subdir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-19">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$newdir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb5-21"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb5-22"></span>
<span id="cb5-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 3: Copy files from `teaching/*/docs/` and `projects/*/docs/` to `docs/teaching/*` and `docs/projects/*`</span></span>
<span id="cb5-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Copying files..."</span></span>
<span id="cb5-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> teaching projects <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-maxdepth</span> 2 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-type</span> d <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-name</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">source_dir</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span>
<span id="cb5-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Determine the parent directory (e.g., teaching/_data-analysis/docs → teaching/_data-analysis)</span></span>
<span id="cb5-27">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">parent_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dirname</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$source_dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-28"></span>
<span id="cb5-29">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove leading `_` from parent directory name</span></span>
<span id="cb5-30">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clean_subdir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$parent_dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s|/_|/|g'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s|^_||'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-31"></span>
<span id="cb5-32">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the target directory in `docs/`</span></span>
<span id="cb5-33">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">target_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$clean_subdir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-34"></span>
<span id="cb5-35">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Copy files if the source directory is not empty</span></span>
<span id="cb5-36">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-d</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$source_dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb5-37">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$source_dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$target_dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/ <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>/dev/null <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb5-38">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Copied files from </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$source_dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> to </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$target_dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-39">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb5-40"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb5-41"></span>
<span id="cb5-42"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Build process completed successfully!"</span></span></code></pre></div>
<hr>
<p>How It Works</p>
<pre><code>Creates directories inside docs/, removing _ from names.
Moves files from teaching/_data-analysis/docs/ → docs/teaching/data-analysis/.
Ensures no files are lost, and empty docs/ directories inside teaching/ and projects/ are ignored.</code></pre>
</section>
<section id="key-fixes" class="level3">
<h3 class="anchored" data-anchor-id="key-fixes"><strong>Key Fixes</strong></h3>
<p>✅ <strong>Removes redundant loops in Step #3</strong> since Step #2 already creates the directory structure.<br>
✅ <strong>Uses <code>cp -r</code> instead of <code>mv</code></strong> to copy files instead of moving them.<br>
✅ <strong>Uses <code>find ... -maxdepth 2 -type d -name "docs"</code></strong> to locate all <code>docs/</code> directories.<br>
✅ <strong>Automatically maps <code>teaching/_data-analysis/docs</code> → <code>docs/teaching/data-analysis/</code></strong> while <strong>removing <code>_</code></strong>.</p>
<hr>
</section>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example"><strong>Example</strong></h3>
<section id="before-running-the-script" class="level4">
<h4 class="anchored" data-anchor-id="before-running-the-script"><strong>Before Running the Script</strong></h4>
<pre><code>teaching/
  _data-analysis/
    docs/
      file1.html
      file2.pdf
  _statistics/
    docs/
      report.md
projects/
  _equity-post-HCT-survival-predictions/
    docs/
      analysis.csv</code></pre>
</section>
<section id="after-running-the-script" class="level4">
<h4 class="anchored" data-anchor-id="after-running-the-script"><strong>After Running the Script</strong></h4>
<pre><code>docs/
  teaching/
    data-analysis/
      file1.html
      file2.pdf
    statistics/
      report.md
  projects/
    equity-post-HCT-survival-predictions/
      analysis.csv</code></pre>
<p>✅ <strong>All files are copied instead of moved</strong><br>
✅ <strong>No redundant loops</strong><br>
✅ <strong><code>_</code> removed from directory names in <code>docs/</code></strong></p>
<hr>
</section>
</section>
<section id="final-thoughts" class="level3">
<h3 class="anchored" data-anchor-id="final-thoughts"><strong>Final Thoughts</strong></h3>
<p>This is now <strong>fully optimized</strong> and should work perfectly for your Quarto project! 🚀<br>
Let me know if you need any tweaks. 😊</p>
</section>
</section>
<section id="complete-explaining" class="level2">
<h2 class="anchored" data-anchor-id="complete-explaining">Complete explaining</h2>
<p>You’re very welcome! 😊 I’m glad it’s working perfectly. Now, let’s go <strong>line by line</strong> and explain exactly what each part of the script does.</p>
<hr>
</section>
<section id="full-script-with-line-by-line-explanation" class="level2">
<h2 class="anchored" data-anchor-id="full-script-with-line-by-line-explanation"><strong>Full Script with Line-by-Line Explanation</strong></h2>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span></code></pre></div>
<ul>
<li>This tells the system to run the script using the <strong>Bash shell</strong>.</li>
</ul>
<hr>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exit on error</span></span>
<span id="cb10-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span></span></code></pre></div>
<ul>
<li><code>set -e</code> ensures that <strong>if any command fails, the script will immediately stop</strong>.<br>
</li>
<li>This prevents silent errors and makes debugging easier.</li>
</ul>
<hr>
<section id="step-1-render-the-quarto-project" class="level3">
<h3 class="anchored" data-anchor-id="step-1-render-the-quarto-project"><strong>Step 1: Render the Quarto project</strong></h3>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 1: Render the Quarto project</span></span>
<span id="cb11-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rendering Quarto project..."</span></span>
<span id="cb11-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">quarto</span> render</span></code></pre></div>
<ul>
<li>Runs <code>quarto render</code>, which <strong>processes</strong> the Quarto files and generates the output inside the <code>docs/</code> folder.<br>
</li>
<li>The <code>echo</code> command prints a message to inform the user.</li>
</ul>
<hr>
</section>
<section id="step-2-create-the-necessary-directory-structure-inside-docs" class="level3">
<h3 class="anchored" data-anchor-id="step-2-create-the-necessary-directory-structure-inside-docs"><strong>Step 2: Create the necessary directory structure inside <code>docs/</code></strong></h3>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 2: Create one level of subdirectories inside docs/, removing `_`</span></span>
<span id="cb12-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Creating directory structure in docs/..."</span></span></code></pre></div>
<ul>
<li>Prints a message to indicate that <strong>the script is creating directories inside <code>docs/</code></strong>.</li>
</ul>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> dir <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> teaching projects<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span></code></pre></div>
<ul>
<li>Loops through two main folders:
<ul>
<li><code>teaching/</code></li>
<li><code>projects/</code></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb14-1">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-maxdepth</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-type</span> d <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">subdir</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span></code></pre></div>
<ul>
<li>Uses <code>find</code> to locate <strong>all immediate subdirectories</strong> (ignoring files) inside <code>teaching/</code> and <code>projects/</code>.</li>
<li><code>-maxdepth 1</code> ensures <strong>only the first-level directories</strong> are processed.</li>
<li><code>-type d</code> filters for <strong>directories only</strong>.</li>
<li>The <code>while read -r subdir; do</code> loop <strong>iterates through each directory found</strong>.</li>
</ul>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb15-1">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove leading `_` from directory names</span></span>
<span id="cb15-2">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clean_subdir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$subdir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s|/_|/|g'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s|^_||'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<ul>
<li>Uses <code>sed</code> (stream editor) to <strong>remove leading underscores (<code>_</code>)</strong> from directory names:
<ul>
<li><code>s|/_|/|g</code> → replaces <code>/_</code> with <code>/</code> (removes <code>_</code> when it’s part of a path).</li>
<li><code>s|^_||</code> → removes <code>_</code> if it’s at the start of the name.</li>
</ul></li>
</ul>
<p>For example:</p>
<pre><code>teaching/_data-analysis → teaching/data-analysis
projects/_equity-post-HCT-survival-predictions → projects/equity-post-HCT-survival-predictions</code></pre>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb17-1">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Construct the corresponding directory inside docs/</span></span>
<span id="cb17-2">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">newdir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$clean_subdir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb17-3">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$newdir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<ul>
<li>Creates a <strong>matching directory structure inside <code>docs/</code></strong>, but without <code>_</code>.<br>
</li>
<li><code>mkdir -p</code> ensures <strong>it only creates directories if they don’t already exist</strong>.</li>
</ul>
<hr>
</section>
<section id="step-3-copy-files-from-docs-folders-in-teaching-and-projects" class="level3">
<h3 class="anchored" data-anchor-id="step-3-copy-files-from-docs-folders-in-teaching-and-projects"><strong>Step 3: Copy Files from <code>/docs/</code> folders in <code>teaching/</code> and <code>projects/</code></strong></h3>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 3: Copy files from `teaching/*/docs/` and `projects/*/docs/` to the corresponding location in `docs/`</span></span>
<span id="cb18-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Copying files..."</span></span></code></pre></div>
<ul>
<li>Prints a message to indicate that <strong>files are now being copied</strong>.</li>
</ul>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> teaching projects <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-maxdepth</span> 2 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-type</span> d <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-name</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">while</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">source_dir</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">do</span></span></code></pre></div>
<ul>
<li>Uses <code>find</code> to locate <strong>all <code>docs/</code> subdirectories</strong> inside <code>teaching/</code> and <code>projects/</code>, up to <strong>two levels deep</strong>.</li>
<li><code>-maxdepth 2</code> ensures it finds <code>docs/</code> only inside first-level subdirectories (e.g., <code>teaching/_data-analysis/docs/</code>).</li>
<li><code>-type d -name "docs"</code> ensures that <strong>only directories named <code>docs</code></strong> are selected.</li>
<li><code>while read -r source_dir; do</code> loops over each <code>docs/</code> folder found.</li>
</ul>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb20-1">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Determine the parent directory (e.g., teaching/_data-analysis/docs → teaching/_data-analysis)</span></span>
<span id="cb20-2">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">parent_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dirname</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$source_dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<ul>
<li>Gets the <strong>parent directory</strong> of <code>docs/</code>, so we know where the files originally belong.
<ul>
<li><p>Example:</p>
<pre><code>teaching/_data-analysis/docs → teaching/_data-analysis</code></pre></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb22-1">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove leading `_` from parent directory name</span></span>
<span id="cb22-2">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clean_subdir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$parent_dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s|/_|/|g'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s|^_||'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<ul>
<li><p><strong>Removes <code>_</code></strong> from the parent directory name, just like in Step 2.</p></li>
<li><p>Example transformation:</p>
<pre><code>teaching/_data-analysis → teaching/data-analysis</code></pre></li>
</ul>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb24-1">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the target directory in `docs/`</span></span>
<span id="cb24-2">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">target_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$clean_subdir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<ul>
<li>Defines where the files <strong>should be copied</strong> inside <code>docs/</code>.</li>
</ul>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb25-1">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Copy files if the source directory is not empty</span></span>
<span id="cb25-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-d</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$source_dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span></code></pre></div>
<ul>
<li><strong>Checks if <code>docs/</code> exists</strong> before attempting to copy files.</li>
</ul>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb26-1">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$source_dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$target_dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/ <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span>/dev/null <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">true</span></span></code></pre></div>
<ul>
<li>Copies <strong>all files</strong> from the source <code>docs/</code> folder into the <strong>corresponding <code>docs/</code> directory</strong>.</li>
<li><code>cp -r</code> ensures it copies <strong>all files and subdirectories</strong>.</li>
<li><code>2&gt;/dev/null || true</code>:
<ul>
<li>Redirects errors (e.g., if <code>docs/</code> is empty) to <strong>prevent script failure</strong>.</li>
<li>The <code>|| true</code> ensures the script <strong>continues running even if no files exist</strong>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb27-1">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Copied files from </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$source_dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> to </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$target_dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<ul>
<li>Prints a confirmation message each time files are copied.</li>
</ul>
<hr>
</section>
<section id="final-step-script-completion-message" class="level3">
<h3 class="anchored" data-anchor-id="final-step-script-completion-message"><strong>Final Step: Script Completion Message</strong></h3>
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb28-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span>
<span id="cb28-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">done</span></span></code></pre></div>
<ul>
<li>Closes both <code>while</code> and <code>for</code> loops.</li>
</ul>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Build process completed successfully!"</span></span></code></pre></div>
<ul>
<li>Prints a final message indicating <strong>the script finished successfully</strong>.</li>
</ul>
<hr>
</section>
</section>
<section id="summary-of-what-the-script-does" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-what-the-script-does"><strong>Summary of What the Script Does</strong></h2>
<ol type="1">
<li><strong>Renders the Quarto project</strong> (<code>quarto render</code>).</li>
<li><strong>Creates directories inside <code>docs/</code></strong>, ensuring that <code>_</code> is removed from names.</li>
<li><strong>Finds all <code>docs/</code> folders inside <code>teaching/</code> and <code>projects/</code></strong>.</li>
<li><strong>Copies files from those <code>docs/</code> folders into the correct <code>docs/</code> directory</strong>.</li>
<li><strong>Ensures the entire process runs smoothly, even if some folders are empty</strong>.</li>
</ol>
<hr>
</section>
<section id="example-before-after-running-the-script" class="level2">
<h2 class="anchored" data-anchor-id="example-before-after-running-the-script"><strong>Example: Before &amp; After Running the Script</strong></h2>
<section id="before" class="level3">
<h3 class="anchored" data-anchor-id="before"><strong>Before</strong></h3>
<pre><code>teaching/
  _data-analysis/
    docs/
      file1.html
      file2.pdf
  _statistics/
    docs/
      report.md
projects/
  _equity-post-HCT-survival-predictions/
    docs/
      analysis.csv</code></pre>
</section>
<section id="after" class="level3">
<h3 class="anchored" data-anchor-id="after"><strong>After</strong></h3>
<pre><code>docs/
  teaching/
    data-analysis/
      file1.html
      file2.pdf
    statistics/
      report.md
  projects/
    equity-post-HCT-survival-predictions/
      analysis.csv</code></pre>
<p>✅ <strong>Files are copied instead of moved</strong><br>
✅ <strong>Underscores <code>_</code> are removed from directory names</strong><br>
✅ <strong>Directory structure is maintained</strong></p>
<hr>
</section>
<section id="final-thoughts-1" class="level3">
<h3 class="anchored" data-anchor-id="final-thoughts-1"><strong>Final Thoughts</strong></h3>
<p>This script is now <strong>fully optimized, efficient, and robust</strong>. 🚀<br>
If you ever need additional tweaks, let me know! 😊</p>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>Quarto</category>
  <guid>https://guillaumegilles.github.io/blog/nested-quarto-projects/</guid>
  <pubDate>Sat, 22 Mar 2025 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Can You Hop to the Lily Pad?</title>
  <dc:creator>Guillaume Gilles</dc:creator>
  <link>https://guillaumegilles.github.io/blog/fiddler-25-01-24/</link>
  <description><![CDATA[ 





<p>This week’s <a href="https://thefiddler.substack.com/p/can-you-hop-to-the-lily-pad">Fiddler on the Proof</a> dives into a playful puzzle about lily pads and a frog hopping around—can you figure out where it will land?</p>
<section id="puzzle" class="level2">
<h2 class="anchored" data-anchor-id="puzzle">Puzzle</h2>
<p>You are a frog in a pond with four lily pads, marked “<code>1</code>” through “<code>4</code>”. You are currently on pad <code>2</code>, and your goal is to make it to pad <code>1</code>. From any given pad, there are specific probabilities that you’ll jump to another pad:</p>
<ul>
<li>Once on pad <code>1</code>, you will happily stay there forever.</li>
<li>From pad <code>2</code>, there’s a 1-in-2 chance you’ll hop to pad <code>1</code>, and a 1-in-2 chance you’ll hop to pad <code>3</code>.</li>
<li>From pad <code>3</code>, there’s a 1-in-3 chance you’ll hop to pad <code>2</code>, and a 2-in-3 chance you’ll hop to pad <code>4</code>.</li>
<li>Once on pad <code>4</code>, you will unhappily stay there forever.</li>
</ul>
<p>Given that you are starting on pad <code>2</code>, <strong>what is the probability that you will ultimately make it to pad <code>1</code></strong> (as opposed to pad 4)?</p>
<section id="solution" class="level3">
<h3 class="anchored" data-anchor-id="solution">Solution</h3>
<p>This puzzle can be solved using <strong>Markov chains</strong>.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
  A((Pad 1))
  style A fill:#9DC183
  B((Pad 2)) -- 1/2 --&gt; A
  style B fill:#9DC183
  C((Pad 3)) -- 2/3 --&gt; D((Pad 4))
  style C fill:#9DC183
  style D fill:#9DC183
  C -- 1/3 --&gt; B
  B -- 1/2 --&gt; C
  D -- 1 --&gt; D
  A -- 1 --&gt; A
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>Pads <code>1</code> and <code>4</code> are absorbing states (once you reach them, you stay there forever), while pads <code>2</code> and <code>3</code> are transient states (you can leave them). Let’s define:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?P_2">: the probability of eventually reaching pad <code>1</code> starting from pad <code>2</code>.</li>
<li><img src="https://latex.codecogs.com/png.latex?P_3">: the probability of eventually reaching pad <code>1</code> starting from pad <code>3</code>.</li>
</ul>
<section id="step-1-probability-equations" class="level4">
<h4 class="anchored" data-anchor-id="step-1-probability-equations">Step 1: Probability equations</h4>
<p>Starting from pad <code>2</code>, there is an equal <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B2%7D"> chance of jumping to pad <code>1</code> or pad <code>3</code>:</p>
<ul>
<li>If the frog jumps to pad <code>1</code>, the journey is complete, so the contribution to <img src="https://latex.codecogs.com/png.latex?P_1"> is <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B2%7D%20%5Ccdot%201">.</li>
<li>If the frog jumps to pad <code>3</code>, the probability of eventually reaching pad <code>1</code> depends on <img src="https://latex.codecogs.com/png.latex?P_3">, with a contribution of <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B2%7D%20%5Ccdot%20P_3">.</li>
</ul>
<p>Thus: <img src="https://latex.codecogs.com/png.latex?%0AP_2%20=%20%5Cfrac%7B1%7D%7B2%7D%20+%20%5Cfrac%7B1%7D%7B2%7D%20%5Ccdot%20P_3.%0A"></p>
<p>From pad <code>3</code>, the frog has a <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B3%7D"> chance of hopping back to pad <code>2</code>, where the probability of reaching pad <code>1</code> is <img src="https://latex.codecogs.com/png.latex?P_2">. If the frog instead jumps to pad <code>4</code> (with probability <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B2%7D%7B3%7D">), the probability of reaching pad <code>1</code> is <img src="https://latex.codecogs.com/png.latex?0">.</p>
<p>Therefore: <img src="https://latex.codecogs.com/png.latex?%0AP_3%20=%20%5Cfrac%7B1%7D%7B3%7D%20%5Ccdot%20P_2.%0A"></p>
</section>
<section id="step-2-solve-for-p_2" class="level4">
<h4 class="anchored" data-anchor-id="step-2-solve-for-p_2">Step 2: Solve for <img src="https://latex.codecogs.com/png.latex?P_2"></h4>
<p>Substitute <img src="https://latex.codecogs.com/png.latex?P_3%20=%20%5Cfrac%7B1%7D%7B3%7D%20%5Ccdot%20P_2"> into the equation for <img src="https://latex.codecogs.com/png.latex?P_2">: <img src="https://latex.codecogs.com/png.latex?%0AP_2%20=%20%5Cfrac%7B1%7D%7B2%7D%20+%20%5Cfrac%7B1%7D%7B2%7D%20%5Ccdot%20%5Cleft(%20%5Cfrac%7B1%7D%7B3%7D%20%5Ccdot%20P_2%20%5Cright).%0A"></p>
<p>Simplify: <img src="https://latex.codecogs.com/png.latex?%0AP_2%20=%20%5Cfrac%7B1%7D%7B2%7D%20+%20%5Cfrac%7B1%7D%7B6%7D%20%5Ccdot%20P_2.%0A"></p>
<p>Rearrange to isolate <img src="https://latex.codecogs.com/png.latex?P_2">: <img src="https://latex.codecogs.com/png.latex?%0AP_2%20%5Ccdot%20%5Cleft(%201%20-%20%5Cfrac%7B1%7D%7B6%7D%20%5Cright)%20=%20%5Cfrac%7B1%7D%7B2%7D.%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0AP_2%20%5Ccdot%20%5Cfrac%7B5%7D%7B6%7D%20=%20%5Cfrac%7B1%7D%7B2%7D.%0A"></p>
<p>Solve for <img src="https://latex.codecogs.com/png.latex?P_2">: <img src="https://latex.codecogs.com/png.latex?%0AP_2%20=%20%5Cfrac%7B1%7D%7B2%7D%20%5Ccdot%20%5Cfrac%7B6%7D%7B5%7D.%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0AP_2%20=%20%5Cfrac%7B3%7D%7B5%7D.%0A"></p>
<p>The probability of eventually reaching pad <code>1</code> starting from pad <code>2</code> is: <img src="https://latex.codecogs.com/png.latex?%0A%5Cfrac%7B3%7D%7B5%7D%0A"></p>


</section>
</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>Fiddler</category>
  <category>Probability</category>
  <category>Puzzle</category>
  <guid>https://guillaumegilles.github.io/blog/fiddler-25-01-24/</guid>
  <pubDate>Sun, 26 Jan 2025 23:00:00 GMT</pubDate>
</item>
</channel>
</rss>
